# =============================================================================
# PostgreSQL PRIMARY - Configuración para Streaming Replication
# =============================================================================

# Conexiones
listen_addresses = '*'
max_connections = 200

# Replicación
wal_level = replica                 # Genera WAL completo para réplicas
max_wal_senders = 10               # Máx. réplicas conectadas simultáneamente
max_replication_slots = 10         # Slots para réplicas (evita limpieza de WAL)
wal_keep_size = 512MB              # Retener WAL para réplicas lentas
hot_standby = on                   # Permitir consultas en réplicas

# Sincronización (ajustable según necesidad)
synchronous_commit = local         # local=sin esperar, on=esperar réplica, remote_apply=0 data loss

# WAL archiving (opcional, para backups)
archive_mode = off
# archive_command = 'test ! -f /archive/%f && cp %p /archive/%f'

# Logging
log_destination = 'stderr'
logging_collector = off
log_statement = 'none'            # all/ddl/mod/none
log_line_prefix = '%t [%p] %u@%d '

# Performance
shared_buffers = 256MB
effective_cache_size = 1GB
maintenance_work_mem = 64MB
